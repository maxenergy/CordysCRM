<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.cordys.crm.integration.mapper.ExtEnterpriseProfileMapper">

    <select id="selectByCreditCode" resultType="cn.cordys.crm.integration.domain.EnterpriseProfile">
        SELECT id, customer_id, iqicha_id, credit_code, company_name, legal_person,
               reg_capital, reg_date, staff_size, industry_code, industry_name,
               province, city, address, status, phone, email, website,
               shareholders, executives, risks, source, last_sync_at,
               organization_id, create_time, update_time, create_user, update_user
        FROM enterprise_profile
        WHERE credit_code = #{creditCode} AND organization_id = #{orgId}
    </select>

    <select id="selectByCustomerId" resultType="cn.cordys.crm.integration.domain.EnterpriseProfile">
        SELECT id, customer_id, iqicha_id, credit_code, company_name, legal_person,
               reg_capital, reg_date, staff_size, industry_code, industry_name,
               province, city, address, status, phone, email, website,
               shareholders, executives, risks, source, last_sync_at,
               organization_id, create_time, update_time, create_user, update_user
        FROM enterprise_profile
        WHERE customer_id = #{customerId}
    </select>

    <select id="searchByCompanyName" resultType="cn.cordys.crm.integration.domain.EnterpriseProfile">
        SELECT id, customer_id, iqicha_id, credit_code, company_name, legal_person,
               reg_capital, reg_date, staff_size, industry_code, industry_name,
               province, city, address, status, phone, email, website,
               shareholders, executives, risks, source, last_sync_at,
               organization_id, create_time, update_time, create_user, update_user
        FROM enterprise_profile
        WHERE company_name LIKE CONCAT('%', #{companyName}, '%')
          AND organization_id = #{orgId}
        ORDER BY create_time DESC
        LIMIT #{offset}, #{limit}
    </select>

    <select id="countByCompanyName" resultType="long">
        SELECT COUNT(1)
        FROM enterprise_profile
        WHERE company_name LIKE CONCAT('%', #{companyName}, '%')
          AND organization_id = #{orgId}
    </select>

</mapper>

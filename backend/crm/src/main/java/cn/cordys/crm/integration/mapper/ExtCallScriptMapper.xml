<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.cordys.crm.integration.mapper.ExtCallScriptMapper">

    <select id="selectByCustomerId" resultType="cn.cordys.crm.integration.domain.CallScript">
        SELECT id, customer_id, opportunity_id, template_id, scene, channel,
               language, tone, tags, content, model, generated_at, organization_id,
               create_time, update_time, create_user, update_user
        FROM call_script
        WHERE customer_id = #{customerId}
        ORDER BY generated_at DESC
        LIMIT #{limit}
    </select>

    <select id="selectByCustomerAndScene" resultType="cn.cordys.crm.integration.domain.CallScript">
        SELECT id, customer_id, opportunity_id, template_id, scene, channel,
               language, tone, tags, content, model, generated_at, organization_id,
               create_time, update_time, create_user, update_user
        FROM call_script
        WHERE customer_id = #{customerId}
        <if test="scene != null and scene != ''">
            AND scene = #{scene}
        </if>
        ORDER BY generated_at DESC
        LIMIT #{limit}
    </select>

</mapper>
